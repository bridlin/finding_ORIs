# finding ORIs in stranded SNS-seq

This repository contains scripts and files used to analyze stranded paired-end SNS-Seq experiments for Stanojcic et al in prep.

The scripts are made to run on a HPC under slurm (Roscoff Bioinformatics platform ABiMS (http://abims.sb-roscoff.fr)).

## The first script qc_mqpping.sh uses raw paired-end stranded sequencing reads from SNS-seq experiments and performs quality check, quality filtering and read mapping.
- quality control of the provided fastq files (fastqc)
- trimming of tail and adapter sequences (cutadapt)
- quality trimming with q20 threshold (trimmomatic)
- alignment against provided indexed genome (bowtie2)
- sorting and conversion fom sam to bam of aligned reads (samtools)
- check for insert size (picard)
- removal of duplicated reads (picard)
- bam file indexing (samtools)
- generation of Multiqc report (multiqc)

### Parameters for this script need to be provided in the config_mapping.txt file:

- output directory name. The directory will be generated by the sript in the working directory.

    output_dir=alignedReads

- list of sample names as found in the fastq files e.g. $sample\L001_R1_001.fastq.gz

    input_list=("x_S1_" "y_S2_" "z_S5_")           

- path to fastq directory

    fastq_directory=path/to/fastqfiles                          

- path and genome prefix of bowtie2 index and genome.fasta

    genome=path/to/genome/myfavorite_Genome    

- genome prefix for filenames of mapped reads

    genome_prefix=myfavorite_Genome  

## The second script finding_ORIs.sh will use aligend reads (sorted bam) and outputs bed files of the detected ORIs 

- seperation of mapped reads in minus and plus strand (samtools)
- strand-seperated peak calling (macs2)
- peak filtering (bedtools and awk) based on three criterias: 
    - distance of minus and plus strand peaks
    - no complete overlap between plus and minus strand peaks
    - right strand orientation (minus followed by plus)

### Parameters for this script need to be provided in the  config_finding-ORIs.txt file:
- path to aligned reads

    read_directory=path/to/aligned_reads                    

- output directory name (generated by the sript in the working directory)

    output_dir=results/myresults  

- prefix of mapped reads ($sample$prefix.bam)

    file_prefix=aln-pe_genomeprefix_sorted_reheadered_dups-removed                     

- sample name as found in bam files 

    input_list=("x_S1_" "y_S2_" "z_S5_")      

- peak overlap to be excluded in percent

    overlap_list=(50)                                                  

- window size for peak pair selection in nucleotides

    window_list=(500)                                       




    

## Authors

- [@bridlinbarckmann](https://www.github.com/bridlin)


## Documentation

[Documentation](https://linktodocumentation)